<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>í•˜ë£¨ì¹˜ ë…¸ì…˜ ì„¤ì • ë„ìš°ë¯¸</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Noto Sans KR', -apple-system, sans-serif;
      max-width: 560px;
      margin: 0 auto;
      padding: 24px;
      background: #1a1a1a;
      color: #e0e0e0;
      line-height: 1.6;
    }
    h1 {
      font-size: 20px;
      margin-bottom: 8px;
      color: #9bbc0f;
    }
    .sub { font-size: 13px; color: #888; margin-bottom: 24px; }
    label {
      display: block;
      font-size: 13px;
      font-weight: bold;
      margin-bottom: 6px;
      color: #8bac0f;
    }
    input, textarea {
      width: 100%;
      padding: 12px;
      font-size: 14px;
      border: 2px solid #306230;
      border-radius: 8px;
      background: #0f380f;
      color: #9bbc0f;
      margin-bottom: 12px;
    }
    input::placeholder, textarea::placeholder { color: #5a7a2f; }
    .result {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px;
      background: #0f380f;
      border-radius: 8px;
      border: 1px solid #306230;
      margin-bottom: 16px;
    }
    .result-id {
      font-family: monospace;
      font-size: 12px;
      word-break: break-all;
      flex: 1;
      color: #9bbc0f;
    }
    .btn {
      padding: 8px 16px;
      font-size: 13px;
      background: #306230;
      color: #9bbc0f;
      border: 2px solid #306230;
      border-radius: 6px;
      cursor: pointer;
      white-space: nowrap;
    }
    .btn:hover { background: #3d7a3d; }
    .btn-copy { background: #0f380f; }
    .section {
      margin-bottom: 32px;
      padding-bottom: 24px;
      border-bottom: 1px dashed #306230;
    }
    .section:last-of-type { border-bottom: none; }
    .hint {
      font-size: 12px;
      color: #888;
      margin-top: 4px;
    }
    .success { color: #9bbc0f; }
    .error { color: #e07c7c; }
    .steps {
      font-size: 13px;
      margin-top: 16px;
    }
    .steps ol { padding-left: 20px; margin: 8px 0; }
    .steps li { margin-bottom: 6px; }
    .steps a { color: #9bbc0f; }
    table { border-collapse: collapse; }
    table td { padding: 4px 8px; border-bottom: 1px solid #2a4a2a; }
    table td:first-child { font-family: monospace; color: #9bbc0f; width: 32%; }
  </style>
</head>
<body>
  <h1>ğŸ¹ í•˜ë£¨ì¹˜ ë…¸ì…˜ ì„¤ì • ë„ìš°ë¯¸</h1>
  <p class="sub">ë§í¬ë§Œ ë¶™ì—¬ë„£ìœ¼ë©´ IDë¥¼ ìë™ìœ¼ë¡œ ì¶”ì¶œí•´ ë“œë ¤ìš”</p>

  <div class="section">
    <h2 style="font-size:15px; margin-bottom:12px; color:#8bac0f;">1. API í‚¤ (NOTION_API_KEY)</h2>
    <label>API í‚¤ / Notion API Key</label>
    <input type="password" id="apiKey" placeholder="í†µí•© ì‹œí¬ë¦¿ì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš” / Paste integration secret">
    <p class="hint"><a href="https://www.notion.so/my-integrations" target="_blank" rel="noopener">ë…¸ì…˜ í†µí•© ë§Œë“¤ê¸°</a> â†’ ì‹œí¬ë¦¿ ë³µì‚¬. í˜ì´ì§€/DBì— í†µí•© "ì—°ê²°" í•„ìˆ˜</p>
  </div>

  <div class="section">
    <h2 style="font-size:15px; margin-bottom:12px; color:#8bac0f;">2. í•˜ë£¨ì¹˜ í˜ì´ì§€ (HARUCHI_PAGE_ID)</h2>
    <label>í•˜ë£¨ì¹˜ í˜ì´ì§€ ë§í¬ / Haruchi Page URL</label>
    <input type="text" id="pageUrl" placeholder="https://notion.so/í•˜ë£¨ì¹˜-abc123def4567890abcdef1234567890">
    <div id="pageResult" class="result" style="display:none;">
      <span class="result-id" id="pageId"></span>
      <button type="button" class="btn btn-copy" onclick="copyId('pageId')">ë³µì‚¬</button>
    </div>
  </div>

  <div class="section">
    <h2 style="font-size:15px; margin-bottom:12px; color:#8bac0f;">3. XP ë¡œê·¸ DB (XP_LOG_DB_ID)</h2>
    <label>XP ë¡œê·¸ DB ë§í¬ / XP Log DB URL</label>
    <input type="text" id="dbUrl" placeholder="https://notion.so/XPë¡œê·¸-DB-abc123def4567890abcdef1234567890">
    <div id="dbResult" class="result" style="display:none;">
      <span class="result-id" id="dbId"></span>
      <button type="button" class="btn btn-copy" onclick="copyId('dbId')">ë³µì‚¬</button>
    </div>
  </div>

  <div class="section">
    <h2 style="font-size:15px; margin-bottom:12px; color:#8bac0f;">4. í•  ì¼ DB (TODO_DB_ID)</h2>
    <label>í•  ì¼ DB ë§í¬ / To-do DB URL</label>
    <input type="text" id="todoDbUrl" placeholder="https://notion.so/í• ì¼-DB-abc123def4567890abcdef1234567890">
    <div id="todoDbResult" class="result" style="display:none;">
      <span class="result-id" id="todoDbId"></span>
      <button type="button" class="btn btn-copy" onclick="copyId('todoDbId')">ë³µì‚¬</button>
    </div>
  </div>

  <div class="section">
    <h2 style="font-size:15px; margin-bottom:12px; color:#8bac0f;">5. ë£¨í‹´ DB (ROUTINE_DB_ID)</h2>
    <label>ë£¨í‹´ DB ë§í¬ / Routine DB URL</label>
    <input type="text" id="routineDbUrl" placeholder="https://notion.so/ë£¨í‹´-DB-abc123def4567890abcdef1234567890">
    <div id="routineDbResult" class="result" style="display:none;">
      <span class="result-id" id="routineDbId"></span>
      <button type="button" class="btn btn-copy" onclick="copyId('routineDbId')">ë³µì‚¬</button>
    </div>
  </div>

  <div class="section">
    <h2 style="font-size:15px; margin-bottom:12px; color:#8bac0f;">6. ìš´ë™ DB (WORKOUT_DB_ID)</h2>
    <label>ìš´ë™ DB ë§í¬ / Workout DB URL</label>
    <input type="text" id="workoutDbUrl" placeholder="https://notion.so/ìš´ë™-DB-abc123def4567890abcdef1234567890">
    <div id="workoutDbResult" class="result" style="display:none;">
      <span class="result-id" id="workoutDbId"></span>
      <button type="button" class="btn btn-copy" onclick="copyId('workoutDbId')">ë³µì‚¬</button>
    </div>
  </div>

  <div class="section">
    <h2 style="font-size:15px; margin-bottom:12px; color:#8bac0f;">7. ë…ì„œ ì„¸ì…˜ DB (READING_SESSION_DB_ID)</h2>
    <label>ë…ì„œ ì„¸ì…˜ DB ë§í¬ / Reading Session DB URL</label>
    <input type="text" id="readingSessionDbUrl" placeholder="https://notion.so/ë…ì„œì„¸ì…˜-DB-abc123def4567890abcdef1234567890">
    <div id="readingSessionDbResult" class="result" style="display:none;">
      <span class="result-id" id="readingSessionDbId"></span>
      <button type="button" class="btn btn-copy" onclick="copyId('readingSessionDbId')">ë³µì‚¬</button>
    </div>
  </div>

  <div class="section">
    <h2 style="font-size:15px; margin-bottom:12px; color:#8bac0f;">8. ë…ì„œ ë„ì„œ DB (READING_BOOK_DB_ID)</h2>
    <label>ë…ì„œ ë„ì„œ DB ë§í¬ / Reading Book DB URL</label>
    <input type="text" id="readingBookDbUrl" placeholder="https://notion.so/ë…ì„œë„ì„œ-DB-abc123def4567890abcdef1234567890">
    <div id="readingBookDbResult" class="result" style="display:none;">
      <span class="result-id" id="readingBookDbId"></span>
      <button type="button" class="btn btn-copy" onclick="copyId('readingBookDbId')">ë³µì‚¬</button>
    </div>
  </div>

  <div class="section">
    <h2 style="font-size:15px; margin-bottom:12px; color:#8bac0f;">9. SNS DB (SNS_DB_ID)</h2>
    <label>SNS DB ë§í¬ / SNS DB URL</label>
    <input type="text" id="snsDbUrl" placeholder="https://notion.so/SNS-DB-abc123def4567890abcdef1234567890">
    <div id="snsDbResult" class="result" style="display:none;">
      <span class="result-id" id="snsDbId"></span>
      <button type="button" class="btn btn-copy" onclick="copyId('snsDbId')">ë³µì‚¬</button>
    </div>
  </div>

  <div class="section">
    <h2 style="font-size:15px; margin-bottom:12px;">ğŸ“¤ í™˜ê²½ë³€ìˆ˜ ì „ì²´ ë³µì‚¬ (Vercel / .env)</h2>
    <div class="paste-guide" style="background:#0f380f; border:1px solid #306230; border-radius:8px; padding:14px; margin-bottom:16px; font-size:13px;">
      <strong style="color:#9bbc0f;">ì–´ë””ì— ë¶™ì—¬ë„£ë‚˜ìš”? / Where to paste?</strong>
      <ul style="margin:10px 0 0 16px; padding:0; color:#b8c98f;">
        <li><strong>ë¡œì»¬ .env</strong> (notion-sync ì‹¤í–‰ìš©): <code style="background:#1a3a1a; padding:2px 6px; border-radius:4px;">notion-sync/.env</code> íŒŒì¼ì„ ì—´ê³ , ì•„ë˜ ë‚´ìš©ì„ <strong>ì „ì²´ ë®ì–´ì“°ê¸°</strong> ë˜ëŠ” ë‚´ìš©ì— ë¶™ì—¬ë„£ê¸°</li>
        <li><strong>Vercel ë°°í¬ìš©</strong>: <a href="https://vercel.com/dashboard" target="_blank" rel="noopener" style="color:#9bbc0f;">Vercel ëŒ€ì‹œë³´ë“œ</a> â†’ í”„ë¡œì íŠ¸ ì„ íƒ â†’ <strong>Settings â†’ Environment Variables</strong> â†’ ê° ë³€ìˆ˜ë¥¼ <strong>í•˜ë‚˜ì”©</strong> ì¶”ê°€ (Nameì— ë³€ìˆ˜ëª…, Valueì— ê°’ ì…ë ¥)</li>
      </ul>
    </div>
    <table style="font-size:11px; color:#888; margin-bottom:12px; width:100%;">
      <tr><td>NOTION_API_KEY</td><td>API í‚¤ / API Key</td></tr>
      <tr><td>HARUCHI_PAGE_ID</td><td>í•˜ë£¨ì¹˜ í˜ì´ì§€ / Haruchi Page</td></tr>
      <tr><td>XP_LOG_DB_ID</td><td>XP ë¡œê·¸ DB / XP Log DB</td></tr>
      <tr><td>TODO_DB_ID</td><td>í•  ì¼ DB / To-do DB</td></tr>
      <tr><td>ROUTINE_DB_ID</td><td>ë£¨í‹´ DB / Routine DB</td></tr>
      <tr><td>WORKOUT_DB_ID</td><td>ìš´ë™ DB / Workout DB</td></tr>
      <tr><td>READING_SESSION_DB_ID</td><td>ë…ì„œ ì„¸ì…˜ DB / Reading Session DB</td></tr>
      <tr><td>READING_BOOK_DB_ID</td><td>ë…ì„œ ë„ì„œ DB / Reading Book DB</td></tr>
      <tr><td>SNS_DB_ID</td><td>SNS DB / SNS DB</td></tr>
    </table>
    <textarea id="envPreview" readonly rows="12" style="font-size:11px; font-family:monospace;"></textarea>
    <button type="button" class="btn" onclick="copyEnv()">ì „ì²´ ë³µì‚¬</button>
  </div>

  <script>
    function extractNotionId(url) {
      if (!url || typeof url !== 'string') return null;
      const trimmed = url.trim();
      // 32ì hex (ëŒ€ì†Œë¬¸ì) ë˜ëŠ” UUID í˜•ì‹ (8-4-4-4-12)
      const hex32 = /([a-fA-F0-9]{32})/;
      const uuid = /([a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12})/;
      // ? ì´ì „ ë¶€ë¶„ì—ì„œ ì°¾ê¸° (query string ì œì™¸)
      const pathPart = trimmed.split('?')[0];
      let match = pathPart.match(uuid) || pathPart.match(hex32);
      if (match) return match[1].replace(/-/g, ''); // APIìš©ìœ¼ë¡œ dash ì œê±°í•œ 32ì
      return null;
    }

    function showResult(resultId, spanId, extractedId) {
      const resultEl = document.getElementById(resultId);
      const spanEl = document.getElementById(spanId);
      if (extractedId && spanEl) {
        spanEl.textContent = extractedId;
        resultEl.style.display = 'flex';
      } else {
        resultEl.style.display = 'none';
      }
      updateEnvPreview();
    }

    function updateEnvPreview() {
      const apiKey = document.getElementById('apiKey').value.trim();
      const pageId = document.getElementById('pageId').textContent;
      const dbId = document.getElementById('dbId').textContent;
      const todoDbId = document.getElementById('todoDbId').textContent;
      const routineDbId = document.getElementById('routineDbId').textContent;
      const workoutDbId = document.getElementById('workoutDbId').textContent;
      const readingSessionDbId = document.getElementById('readingSessionDbId').textContent;
      const readingBookDbId = document.getElementById('readingBookDbId').textContent;
      const snsDbId = document.getElementById('snsDbId').textContent;
      const lines = [
        'NOTION_API_KEY=' + (apiKey || 'ì—¬ê¸°ì—_í†µí•©_ì‹œí¬ë¦¿_ë¶™ì—¬ë„£ê¸°'),
        'HARUCHI_PAGE_ID=' + (pageId || ''),
        'XP_LOG_DB_ID=' + (dbId || ''),
        'TODO_DB_ID=' + (todoDbId || ''),
        'ROUTINE_DB_ID=' + (routineDbId || ''),
        'WORKOUT_DB_ID=' + (workoutDbId || ''),
        'READING_SESSION_DB_ID=' + (readingSessionDbId || ''),
        'READING_BOOK_DB_ID=' + (readingBookDbId || ''),
        'SNS_DB_ID=' + (snsDbId || ''),
      ];
      document.getElementById('envPreview').value = lines.join('\n');
    }

    function copyId(elId) {
      const id = document.getElementById(elId).textContent;
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(id).then(() => alert('ë³µì‚¬ë¨: ' + id));
      } else {
        prompt('ì•„ë˜ IDë¥¼ ë³µì‚¬í•˜ì„¸ìš”', id);
      }
    }

    function copyEnv() {
      const text = document.getElementById('envPreview').value;
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(text).then(() => alert('í™˜ê²½ë³€ìˆ˜ ì˜ˆì‹œ ë³µì‚¬ë¨'));
      } else {
        prompt('ì•„ë˜ ë‚´ìš©ì„ ë³µì‚¬í•˜ì„¸ìš”', text);
      }
    }

    function bindUrlInput(inputId, resultId, spanId) {
      const el = document.getElementById(inputId);
      el.addEventListener('input', function() {
        showResult(resultId, spanId, extractNotionId(this.value));
      });
      el.addEventListener('paste', function() {
        setTimeout(() => showResult(resultId, spanId, extractNotionId(this.value)), 10);
      });
    }

    document.getElementById('apiKey').addEventListener('input', updateEnvPreview);

    bindUrlInput('pageUrl', 'pageResult', 'pageId');
    bindUrlInput('dbUrl', 'dbResult', 'dbId');
    bindUrlInput('todoDbUrl', 'todoDbResult', 'todoDbId');
    bindUrlInput('routineDbUrl', 'routineDbResult', 'routineDbId');
    bindUrlInput('workoutDbUrl', 'workoutDbResult', 'workoutDbId');
    bindUrlInput('readingSessionDbUrl', 'readingSessionDbResult', 'readingSessionDbId');
    bindUrlInput('readingBookDbUrl', 'readingBookDbResult', 'readingBookDbId');
    bindUrlInput('snsDbUrl', 'snsDbResult', 'snsDbId');

    updateEnvPreview();
  </script>
</body>
</html>
